# 代码版本与分支管理规范
在每个多人协作开发的模块中都存在着并行开发、并行测试、短间隔内上线的情况。在这种情况下如果还使用主干开发主干上线的模式，极容易出现代码混乱导致上线错误的问题。

除了主干开发主干上线这种模式，还有分支开发主干上线与分支开发分支上线两种版本管理模式，各有优缺点。**经过讨论确定采用（分支开发、分支上线）作为团队版本管理的标准流程**，为了方便大家理解，将三种模式都描述如下：

## 主干开发、主干上线
只适合于单人开发的简单模块或者多人开发模块的首次上线前。
**高风险，严重不推荐使用。**

## 分支开发、主干上线
所有开发活动在通过拉分支完成，比如feature、fixbug等；上线前时分支必须merge到主干，然后通过主干完成上线。具体参见：http://agroup.baidu.com/media/md/article/89573
需要注意的点：

1. 提测使用分支提测，在分支修复bug；
2. 如果主干有上线，分支需要合并主干并再次提测回归；
3. 测试完成，上线分支合入主干并回归；

## 分支开发、分支上线
在此模型中，主干当做一个特殊分支对待，也可以在主干上开发、上线，但是并不推荐。推荐的流程为：

1. 拉分支
2. 开发
3. 提测
4. 修正bug
5. 如有已发布版本，合并版本到此分支，回到3
6. 上线
7. 上线分支同步到主干

对比分支开发、主干上线，省去了merge回主干这一步，单向的merge不容易出错；主干不再是所有发布版本的唯一托管地，需要依赖agile的发布记录来找到最新的发布版本所对应的分支和tag，从发布tag拉新的分支。

由于agile对icode托管的代码没有提供scm那样的版本合入提示与限制，只能依赖于icode的提示合入版本。icode的提示没有强制性，需要同学们多去check分支是否有版本需要合入。